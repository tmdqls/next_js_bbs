# **インタフェース設計書**

## **1. ユーザー登録 (POST /register)**
- **目的**: 新しいアカウントを作成
- **入力パラメータ**:
  - `email`: ユーザーのメールアドレス  
  - `password`: ユーザーのパスワード  
  - `name`: ユーザー名  
- **処理フロー**:
```
    [画面] -->[ユーザ情報登録] -->[画面]
```
- **レスポンス**:
  - 成功: 200 Created（アカウント作成成功メッセージ）  
  ```json
  { 
    "code": 200,
    "message": "アカウント作成成功",
    "data": {
      "access_token": "eyJhbGciOiJIUzI1NiIs...",
      "refresh_token": "dGhpcyBpcyBhbiBle..."
    }
  }
  ```
  - 失敗: 400 Bad Request（不正な入力データ）  
  ```json
  { 
    "code":400,
    "message": "アカウント作成失敗",
    "errors": {
      "email": "エラー理由",
      "password": "エラー理由",
      "name": "エラー理由"
    }
  }
  ```

---
## **2. ログイン (POST /login)**
- **目的**: ユーザーのログイン  
- **入力パラメータ**:  
  - `email`: ユーザーのメールアドレス  
  - `password`: ユーザーのパスワード  
- **処理**:  
  - メールアドレスでユーザーを検索  
  - パスワードの一致を確認  
  - リフレッシュ、アクセッサトークンを返す

- **処理フロー**:  
```
    [画面] -->[ユーザ情報チェック] -->[画面]
```

- **レスポンス**:  
  - 成功: 200 OK（JWTトークンを返す）
  ```json
  { 
    "code": 200,
    "message": "ログイン成功",
    "data": {
      "access_token": "eyJhbGciOiJIUzI1NiIs...",
      "refresh_token": "dGhpcyBpcyBhbiBle..."
    }
  }
  ```
  - 失敗: 400 Unauthorized（メールまたはパスワードが不正）  
  ```json
  { 
    "code" :400,
    "message": "ログイン失敗",
    "errors": {
      "reason": "失敗内容"
    }
  }
  ```
---

## **3. 記事一覧の取得 (GET /board)**
- **目的**: 記事の一覧を取得
- **入力パラメータ**:  
  - `page`: ページ番号  
  - `category`: カテゴリ  
  - `searchOption`: 検索オプション（タイトル、作成者、コンテンツ）
  - `search`: 検索する文字
  - `sortBy`: 並び替えオプション（例: `created_at`, `like_count`）  
  - `sortOrder`: 並び替え順序（`asc` または `desc`） 
- **処理**:  
  - ページングおよび検索条件に基づき記事を取得
  - 指定されたソートオプションで並び替え
- **処理フロー**:  
```
    [画面] -->[記事一覧取得] -->[画面]
```

- **レスポンス**:  
  - 成功: 200 OK（記事一覧およびページングデータ）
  ```json
  { 
    "code": 200,
    "page": 1,
    "total_pages": 2,
    "articles": [
      {
        "id": 1,
        "title": "記事タイトル1",
        "author": "作成者1",
        "category": "カテゴリ1",
        "created_at": "2025-01-01",
        "like_count": 10,
        "content": "記事の内容1"
      },
      {
        "id": 2,
        "title": "記事タイトル2",
        "author": "作成者2",
        "category": "カテゴリ2",
        "created_at": "2025-01-02",
        "like_count": 5,
        "content": "記事の内容2"
      }
    ]
  }
  ```
  - 失敗: 400 Bad Request（不正な入力データ）
  ```json
  {
    "code": 400,
    "message": "入力データが不正です。",
    "errors": {
      "page": "ページ番号は1以上の整数を指定してください。",
      "category": "カテゴリが無効です。",
      "searchOption": "検索オプションは 'title', 'author', 'content' のいずれかを指定してください。",
      "search": "検索ワードは1文字以上入力してください。",
      "sortBy": "並び替えオプションは 'created_at' または 'like_count' を指定してください。",
      "sortOrder": "並び順は 'asc' または 'desc' を指定してください。"
    }
  }
  ```
---

## **4. 記事作成 (POST /auth/board)**
- **目的**: 新しい記事を作成  
- **入力パラメータ**:  
  - `category`: 記事カテゴリ  
  - `title`: 記事タイトル  
  - `content`: 記事内容記事
- **処理**:
  - ログイン中のユーザーIDを確認
  - 新しい記事を作成し保存  
- **レスポンス**:  
  - 成功: 201 Created（記事作成成功メッセージ）  
  - 失敗: 400 Bad Request（不正な入力データ）  

---

## **5. 記事編集 (PUT /auth/board/[id])**
- **目的**: 記事を編集  
- **入力パラメータ**:
  - `post_id`: 記事のid
  - `category`: 記事カテゴリ  
  - `title`: 編集後のタイトル  
  - `content`: 編集後の内容  
- **処理**:  
  - 記事作成者がログイン中のユーザーと一致するか確認  
  - 記事内容を更新  
- **レスポンス**:  
  - 成功: 200 OK（編集成功メッセージ）  
  - 失敗: 403 Forbidden（記事者以外の場合）  

---

## **6. 記事削除 (DELETE /auth/board/[id])**
- **目的**: 記事を削除
- **入力パラメータ**:  
  - `post_id`: 記事のid 
- **処理**:  
  - 記事作成者がログイン中のユーザーと一致するか確認  
  - 記事を削除  
- **レスポンス**:  
  - 成功: 200 OK（削除成功メッセージ）  
  - 失敗: 403 Forbidden（記事者以外の場合）  

---

## **7. コメント作成 (POST /auth/comments)**
- **目的**: 記事にコメントを作成  
- **入力パラメータ**:  
  - `content`: コメント内容  
- **処理**:  
  - ログイン中のユーザーIDを確認
  - コメントを作成し保存  
- **レスポンス**:  
  - 成功: 201 Created（コメント作成成功メッセージ）  
  - 失敗: 400 Bad Request（不正な入力データ）  

---

## **8. コメント削除 (DELETE /auth/comments/[comment_id])**
- **目的**: コメントを削除
- **入力パラメータ**:  
  - `comment_id`: コメントid
- **処理**:  
  - コメント作成者がログイン中のユーザーと一致するか確認  
  - コメントを削除  
- **レスポンス**:  
  - 成功: 200 OK（削除成功メッセージ）  
  - 失敗: 403 Forbidden（作成者以外の場合）

---
## **9. 会員情報修正 (PUT /auth/user)**
- **目的**: 会員情報を更新  
- **入力パラメータ**:  
  - `name`: 新しいユーザー名（任意）  
  - `password`: 新しいパスワード（任意）  
- **処理**:  
  - ログイン中のユーザーIDを確認  
  - 入力された情報でユーザー情報を更新 
- **処理フロー**:  
```
    [画面] -->[ユーザー情報修正] -->[画面]
```
- **レスポンス**:  
  - 成功: `200 OK`（更新成功メッセージ）
  ```json
  { 
    "code": 200,
    "message": "修正に成功しました。",
    "data" : {
      "access_token": "eyJhbGciOiJIUzI1NiIs...",
      "refresh_token": "dGhpcyBpcyBhbiBle..."
    }
  }
  ```
  - 失敗: `400 Bad Request`（不正な入力データ） 
  ```json
  { "code":400,
    "message": "修正に失敗しました。",
    "errors": {
      "name" : "nameは1〜15文字で入力してください。",
      "password" : "passwordは8〜15文字で入力してください。"
    }
  }
  ```
  - 失敗: `401 Unauthorized`（認証情報が無効）  
  ```json
  {
    "code": 401,
    "message": "認証に失敗しました。",
    "errors": {
      "token": "トークンが無効です。再ログインしてください。"
    }
  }
  ```

---

## **10. 会員退会 (DELETE /auth/user)**
- **目的**: ユーザーアカウントを削除 
- **処理**:  
  - ログイン中のユーザーIDを確認  
  - ユーザーアカウントを削除
- **処理フロー**:  
```
    [画面] -->[ユーザー情報削除] -->[画面]
```
- **レスポンス**:  
  - 成功: `200 OK`（退会成功メッセージ） 
  ```json
  { "code": 200,
    "message": "アカウントが削除されました。",
  }
  ```
    - 失敗: `400 Bad Request`（不正な入力データ） 
  ```json
  { "code":400,
    "message": "修正に失敗しました。",
    "errors": {
      "name" : "nameは1〜15文字で入力してください。",
      "password" : "passwordは8〜15文字で入力してください。"
    }
  }
  ```
  - 失敗: `401 Unauthorized`（認証情報が無効）  
  ```json
  {
    "code": 401,
    "message": "認証に失敗しました。",
    "errors": {
      "token": "トークンが無効です。再ログインしてください。"
    }
  }
  ```
---